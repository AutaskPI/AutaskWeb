<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Cadastro de Estabelecimento</title>
    <script src="js/jquery.js"></script>
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="css/sb-admin.css" rel="stylesheet">
    <link href="css/index.css" rel="stylesheet">
    <link rel="icon" href="img/logoOficial.png" type="imagem/x-icon">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery.mask.min.js" /></script>
    
</head>

<body class="fixed-nav sticky-footer" style="background-color: #494f56" id="page-top">
    <style rel="stylesheet" type="text/css">
        .esconder {
            display: none;
            color: red;
        }
    </style>
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-dark navbar-fixed-top" id="mainNav">
        <img class="hidden-sm-down" src="img/teste.png" alt="Logo" id="imagemlogo">
        <a id="textoLogo" class="navbar-brand" href="index.html" style="font-size:25px">Autask</a>

        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive"
            aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav navbar-sidenav" id="exampleAccordion">
                <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Components">
                    <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents" data-parent="#exampleAccordion">
                        <i class="fa fa-user-circle"></i>
                        <span class="nav-link-text"> Cadastro</span>
                    </a>
                    <ul class="sidenav-second-level collapse" id="collapseComponents">
                        <li>
                            <a href="Cadastro_Servicos.html">Cadastro de Serviço</a>
                        </li>

                        <li>
                            <a href="Cadastro_Estabelecimento.html">Cadastro de Estabelecimento</a>
                        </li>

                        <li>
                            <a href="Cadastro_Profissional.html">Cadastro de Profissional</a>
                        </li>

                        <li>
                            <a href="Cadastro_Horarios_Disponiveis.html">Cadastro de Horarios Disponiveis</a>
                        </li>

                        <li>
                            <a href="Cadastro_nao_cliente.html">Cadastro de cliente</a>
                        </li>
                    </ul>
                </li>
                <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Example Pages">
                    <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseExamplePages" data-parent="#exampleAccordion">
                        <i class="fa fa-briefcase"></i>
                        <span class="nav-link-text"> Financeiro</span>
                    </a>
                    <ul class="sidenav-second-level collapse" id="collapseExamplePages">
                        <li>
                            <a href="#">Deashboard de ganho</a>
                        </li>
                    </ul>
                </li>
                <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Menu Levels">
                    <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseMulti" data-parent="#exampleAccordion">
                        <i class="fa fa-calendar-o"></i>
                        <span class="nav-link-text">Agenda</span>
                    </a>
                    <ul class="sidenav-second-level collapse" id="collapseMulti">
                        <li>
                            <a href="#">Registros</a>
                        </li>

                        <li>
                            <a href="#">Agenda</a>
                        </li>

                    </ul>
                </li>
            </ul>
            <ul class="navbar-nav sidenav-toggler" style="background-color:#444">
                <li class="nav-item">
                    <a class="nav-link text-center" id="sidenavToggler">
                        <i class="fa fa-fw fa-angle-left"></i>
                    </a>
                </li>
            </ul>
            <ul class="navbar-nav ml-auto">
                <li id="sair" class="nav-item">
                    <a class="nav-link" data-toggle="modal" data-target="#exampleModal" href="login.html" id="exit">
                        <i class="fa fa-fw fa-sign-out "></i>Sair</a>
                </li>
            </ul>
        </div>
    </nav>
    <!-- Começo do conteudo interno-->
    <div class="content-wrapper">
        <div id="TituloPagina">
            <h4>Cadastro do Estabelecimento</h4>
        </div>
        <br></br>
        <div class="container-fluid">
            <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#Estabelecimento" id="cadastro">Cadastro</button>
        </div>
        <br></br>
        <div style="padding: 15px">
            <table id="example" class="display">
                <thead>
                    <tr>
                        <th id="erazao">Razão Social</th>
                        <th id="enome">Nome Fantasia</th>
                        <th id="edescricao">Descrição</th>
                        <th id="ehorario">Horario de funcionamento</th>
                        <th id="ecnpj">CNPJ</th>
                        <th id="ecelular">Celular</th>
                        <th id="elogadoro">Logadoro</th>
                        <th id="euf">UF</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
    <!-- /.container-fluid-->
    <!-- /.content-wrapper-->
    <footer class="sticky-footer ">
        <div class="container ">
            <div class="text-center ">
                <small>Copyright © Autask Reviews 2018</small>
            </div>
        </div>
    </footer>
    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded " href="#page-top ">
        <i class="fa fa-angle-up "></i>
    </a>
    <!-- Logout Modal-->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content ">
                <div class="modal-header ">
                    <h5 class="modal-title " id="exampleModalLabel ">Confirmar Saida</h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body ">Deseja realmente sair?</div>
                <div class="modal-footer ">
                    <button class="btn btn-secondary " type="button " data-dismiss="modal">Cancelar</button>
                    <a class="btn btn-primary " href="login.html ">Sair</a>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal Cadastro -->
    <div class="modal fade" id="Estabelecimento" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Cadastro</h5>
                    <button type="button" class="close" data-dismiss="modal">
                        <span>x</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-12 text-center">
                            <h5 class="display-4" style="font-size: 40px">Cadastro de Estabelecimento</h5>
                        </div>
                    </div>
                    <div class="row mb-5">
                        <div class="col-sm-12 text-center">
                            <form class="col s12">
                                <div class="row">
                                    <div class="form-group col-sm-12">
                                        <label for="inputrazao">Razão Social</label>
                                        <input type="text" class="form-control" name="Nome" id="inputrazao" placeholder="Razão Social">
                                        <p id="msgErrorazao" class="msgErro esconder">Preencher o campo razão social é obrigatório !</p>
                                    </div>

                                    <div class="form-group col-sm-12">
                                        <label for="inputnome">Nome Fantasia</label>
                                        <input type="text" class="form-control" name="NomeFantasia" id="inputnome" placeholder="Nome Fantasia">
                                        <p id="msgErronome" class="msgErro esconder">Preencher o campo nome fantasia é obrigatório !</p>
                                    </div>

                                    <div class="form-group col-sm-6">
                                        <label for="inputhorario">Horário de Funcionamento</label>
                                        <input type="text" class="form-control" name="HorarioFuncionamento" id="inputhorario" placeholder="Horario">
                                        <p id="msgErrohorario" class="msgErro esconder">Preencher o campo horario é obrigatório !</p>
                                    </div>

                                    <div class="form-group col-sm-6">
                                        <label for="inputcontato">E-mail de contato</label>
                                        <input class="form-control" type="email" name="EmailContato" id="inputcontato" placeholder="Email">
                                    </div>

                                    <div class="form-group col-sm-6">
                                        <label for="inputcnpj">CNPJ</label>
                                        <input type="text" maxlength="18" class="form-control inputcnpj" name="CNPJ" id="inputcnpj" placeholder="CNPJ" pattern="\([0-9]{2}\)[\s][0-9]{4}-[0-9]{4,5}">
                                        <script type="text/javascript">$("#inputcnpj").mask("99.999.999/9999-99");</script>
                                        <p id="msgErrocnpj" class="msgErro esconder">Preencher o campo CNPJ é obrigatório !</p>
                                        <p id="msgErrocnpj2" class="msgErro esconder">Digite o CNPJ corretamente!</p>
                                    </div>

                                    <div class="form-group col-sm-6">
                                        <label for="inputvalor">Coloque sua logo!</label>
                                        <input type="file" class="form-control-file" name="CaminhoLogo" id="inputvalor" aria-describedby="filehelp">
                                    </div>

                                    <div class="form-group col-sm-6">
                                        <label for="inputelefone">Telefone</label>
                                        <input type="text/javascript" class="form-control" name="Telefone" id="inputelefone" placeholder="Telefone" pattern="\([0-9]{2}\)[\s][0-9]{4}-[0-9]{4,5}">
                                        <script type="text/javascript">$("#inputelefone").mask("(00) 0000-0000");</script>
                                        <p id="msgErrotelefone" class="msgErro esconder">Preencher o campo telefone é obrigatório !</p>
                                        <p id="msgErrotelefone2" class="msgErro esconder">Digite o numero do telefone corretamente!</p>
                                    </div>

                                    <div class="form-group col-sm-6">
                                        <label for="inputcelular">Celular</label>
                                        <input type="text" maxlength="11" class="form-control" name="Celular" id="inputcelular" placeholder="Celular" pattern="\([0-9]{2}\)[\s][0-9]{4}-[0-9]{4,5}">
                                        <script type="text/javascript">$("#inputcelular").mask("(00) 0000-00000");</script>
                                        <p id="msgErrocelular" class="msgErro esconder">Preencher o campo celular é obrigatório !</p>
                                        <p id="msgErrocelular2" class="msgErro esconder">Digite o numero do celular corretamente!</p>

                                    </div>

                                    <div class="form-group col-sm-12">
                                        <label for="inputdescricao">Descrição do Estabelecimento</label>
                                        <textarea class="form-control" rows="5" name="Descricao" id="inputdescricao" placeholder="Descreva seu Estabelecimento."></textarea>

                                    </div>
                                </div>
                                <h2>Endereço</h2>
                                <div class="row">
                                    <div class="form-group col-sm-4">
                                        <label for="cep">CEP</label>
                                        <input type="text" class="form-control" name="CEP" id="cep" placeholder="Escreva seu CEP">
                                        <script type="text/javascript">$("#cep").mask("00000-000");</script>
                                        <small id="emailHelp" class="form-text text-muted text-left">Escreva somente os números</small>
                                        <p id="msgErrocep" class="msgErro esconder">Preencher o campo CEP é obrigatório !</p>
                                        <p id="msgErrocep2" class="msgErro esconder">Digite o CEP corretamente!</p>
                                    </div>

                                    <div class="form-group col-sm-2">
                                        <button type="button" class="btn btn-info mt-4" id="buscarcep">Buscar</button>
                                    </div>

                                    <div class="form-group col-sm-6">
                                        <label for="rua">Rua</label>
                                        <input type="text" class="form-control" name="Logradouro" id="rua" placeholder="Rua" disabled>
                                    </div>

                                    <div class="form-group col-sm-6">
                                        <label for="cidade">Cidade</label>
                                        <input type="text" class="form-control" name "Cidade" id="cidade" placeholder="Cidade" disabled>
                                    </div>

                                    <div class="form-group col-sm-6">
                                        <label for="bairro">Bairro</label>
                                        <input type="text" class="form-control" name="Bairro" id="bairro" placeholder="Bairro" disabled>
                                    </div>

                                    <div class="form-group col-sm-3">
                                        <label for="uf">UF</label>
                                        <input type="text" class="form-control" name="UF" id="uf" placeholder="UF" disabled>
                                    </div>

                                    <div class="form-group col-sm-3">
                                        <label for="numero">Numero</label>
                                        <input type="text" class="form-control" name="Numero" id="numero" placeholder="N°">
                                        <p id="msgErronumero" class="msgErro esconder">Preencher o campo numero é obrigatório!!</p>
                                        <p id="msgErronumero2" class="msgErro esconder">Digite o numero corretamente!</p>
                                    </div>

                                    <div class="form-group col-sm-6">
                                        <label for="complemento">Complemento</label>
                                        <input type="text" class="form-control" name="Complemento" id="complemento" placeholder="Complemento">
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="cancelar" type="reset" class="btn btn-primary" data-dismiss="modal">Cancelar</button>
                    <button id="cadastrar" type="button" class="btn btn-primary">Cadastrar </button>
                    <!-- Esta feito para fechar somente-->
                </div>
            </div>
        </div>
    </div>
    <script>
        // Parte JavaScript--
        var gridEstabelecimento;
        $(document).ready(function () {
            
            gridEstabelecimento = $('#example').DataTable({
                "language": {
                    "sEmptyTable": "Nenhum registro encontrado",
                    "sInfo": "Mostrando de START até END de TOTAL registros",
                    "sInfoEmpty": "Mostrando 0 até 0 de 0 registros",
                    "sInfoFiltered": "(Filtrados de MAX registros)",
                    "sInfoPostFix": "",
                    "sInfoThousands": ".",
                    "sLengthMenu": "Mostrando MENU resultados por página",
                    "sLoadingRecords": "Carregando...",
                    "sProcessing": "Processando...",
                    "sZeroRecords": "Nenhum registro encontrado",
                    "sSearch": "Pesquisar",
                    "oPaginate": {
                        "sNext": "Próximo",
                        "sPrevious": "Anterior",
                        "sFirst": "Primeiro",
                        "sLast": "Último"
                    },
                    "oAria": {
                        "sSortAscending": ": Ordenar colunas de forma ascendente",
                        "sSortDescending": ": Ordenar colunas de forma descendente"
                    }
                },
            });
            

            $('#inputrazao').blur(function () {
                if ($(this).val() == null || $(this).val().trim() == "")
                    $('#msgErrorazao').fadeIn();
                else
                    $('#msgErrorazao').fadeOut(0);
            });

            $('#inputnome').blur(function () {
                if ($(this).val() == null || $(this).val().trim() == "")
                    $('#msgErronome').fadeIn();
                else
                    $('#msgErronome').fadeOut(0);
            });

            $('#inputhorario').blur(function () {
                if ($(this).val() == null || $(this).val().trim() == "")
                    $('#msgErrohorario').fadeIn();
                else
                    $('#msgErrohorario').fadeOut(0);

            });

            $('#inputcnpj').blur(function () {
                var cnpj = $('#inputcnpj').val();
                if ($(this).val() == null || $(this).val().trim() == "") {
                    $('#msgErrocnpj').fadeIn();
                    $('#msgErrocnpj2').fadeOut(0);
                } else {
                    $('#msgErrocnpj').fadeOut(0);
                    if (cnpj.length < 18)
                        $('#msgErrocnpj2').fadeIn();
                    else
                        $('#msgErrocnpj2').fadeOut(0);
                }
            });

            $('#inputelefone').blur(function () {
                var telefone = $('#inputelefone').val();
                if ($(this).val() == null || $(this).val().trim() == "") {
                    $('#msgErrotelefone').fadeIn();
                    $('#msgErrotelefone2').fadeOut(0);
                } else {
                    $('#msgErrotelefone').fadeOut(0);
                    if (telefone.length < 14)
                        $('#msgErrotelefone2').fadeIn();
                    else
                        $('#msgErrotelefone2').fadeOut(0);
                }
            });

            $('#inputcelular').blur(function () {
                var celular = $('#inputcelular').val();
                if ($(this).val() == null || $(this).val().trim() == "") {
                    $('#msgErrocelular').fadeIn();
                    $('#msgErrocelular2').fadeOut(0);
                } else {
                    $('#msgErrocelular').fadeOut(0);
                    if (celular.length < 14)
                        $('#msgErrocelular2').fadeIn();
                    else
                        $('#msgErrocelular2').fadeOut(0);
                }
            });

            $('#cep').blur(function () {
                var cep = $('#cep').val();
                if ($(this).val() == null || $(this).val().trim() == "") {
                    $('#msgErrocep').fadeIn();
                    $('#msgErrocep2').fadeOut(0);
                } else {
                    $('#msgErrocep').fadeOut(0);
                    if (cep.length < 9)
                        $('#msgErrocep2').fadeIn();
                    else
                        $('#msgErrocep2').fadeOut(0);
                }
            });

            $('#numero').blur(function () {
                var numero = $('#numero').val();
                if ($(this).val() == null || $(this).val().trim() == "")
                    $('#msgErronumero').fadeIn();
                else {
                    $('#msgErronumero').fadeOut(0);
                    if (isNaN(numero))
                        $('#msgErronumero2').fadeIn();
                    else
                        $('#msgErronumero2').fadeOut(0);
                }

            });
            
            CarregarEstabelecimentos();
        })
            $('#buscarcep').click(function () {
                var cep = $('#cep').val();
                var url = 'https://viacep.com.br/ws/' + cep + '/json';
                $.getJSON(url, function (data) {
                    if ("error" in data) {
                        console.log("Deu bosta");
                    }
                    $('#rua').val(data.logradouro);
                    $('#bairro').val(data.bairro);
                    $('#cidade').val(data.localidade);
                    $('#uf').val(data.uf);
                    $('#complemento').val(data.complemento);
                    $('#numero').val(data.numero);
                })
            });

            

            $('#cadastrar').click(function () {

                var Estabelecimento = {
                    Nome: string = razao,
                    TipoPessoa: "J",
                    CNPJ: string = cnpj,
                    Telefone: string = telefone,
                    Celular: string = celular,
                    EmailContato: string = contato,
                    NomeFantasia: string = nome,
                    Descricao: string = descricao,
                    HorarioFuncionamento: string = horario,
                    Logradouro: string = rua,
                    CEP: string = cep,
                    Bairro: string = bairro,
                    UF: string = uf,
                    Cidade: string = cidade,
                    Numero: string = numero,
                    Complemento: string = complemento,
                    CaminhoLogo: string = valor


                }

        function validarFomulario() {
            var razao = $('#inputrazao').val();
            var nome = $('#inputnome').val();
            var horario = $('#inputhorario').val();
            var cnpj = $('#inputcnpj').val();
            var valor = $('#inputvalor').val();
            var contato = $('#inputcontato').val();
            var telefone = $('#inputelefone').val();
            var celular = $('#inputcelular').val();
            var descricao = $('#inputdescricao').val();
            var cep = $('#cep').val();
            var numero = $('#numero').val();
            var rua = $('#rua').val();
            var bairro = $('#bairro').val();
            var cidade = $('#cidade').val();
            var uf = $('#uf').val();
            var complemento = $('#complemento').val();
        }
        if (razao == null || razao == "") 
            $('#msgErrorazao').fadeIn();
        else
            $('#msgErrorazao').fadeOut(0);

        if (nome == null || nome == "")
            $('#msgErronome').fadeIn();
        else
            $('#msgErronome').fadeOut(0);

        if (horario == null || horario == "") {
            $('#msgErrohorario').fadeIn();
        }
        else {
            $('#msgErrohorario').fadeOut(0);
        }
        if (cnpj == null || cnpj == "") {
            $('#msgErrocnpj').fadeIn();
            $('#msgErrocnpj2').fadeOut(0);
        } else {
            $('#msgErrocnpj').fadeOut(0);
            if (cnpj.length < 18)
                $('#msgErrocnpj2').fadeIn();
            else
                $('#msgErrocnpj2').fadeOut(0);
        }

        if ((telefone == null) || (telefone == '')) {
            $('#msgErrotelefone').fadeIn();
            $('#msgErrotelefone2').fadeOut(0);
        } else {
            $('#msgErrotelefone').fadeOut(0);
            if (telefone.length < 14)
                $('#msgErrotelefone2').fadeIn();
            else
                $('#msgErrotelefone2').fadeOut(0);
        }

        if (celular == null || celular == "") {
            $('#msgErrocelular').fadeIn();
            $('#msgErrocelular2').fadeOut(0);
        } else {
            $('#msgErrocelular').fadeOut(0);
            if (celular.length < 14)
                $('#msgErrocelular2').fadeIn();
            else
                $('#msgErrocelular2').fadeOut(0);
        }

        if (cep == null || cep == "") {
            $('#msgErrocep').fadeIn();
            $('#msgErrocep2').fadeOut(0);
        } else {
            $('#msgErrocep').fadeOut(0);
            if (cep.length < 9)
                $('#msgErrocep2').fadeIn();
            else
                $('#msgErrocep2').fadeOut(0);
        }

        if (numero == null || numero == "") {
            $('#msgErronumero').fadeIn();
        }
        else {
            $('#msgErronumero').fadeOut(0);
            if (isNaN(numero))
                $('#msgErronumero2').fadeIn();
            else
                $('#msgErronumero2').fadeOut(0);
        }

        if (descricao == null || descricao == "") { }
        else {
            alert("valido");
        }
    })
    function CarregarEstabelecimentos(){
        $.ajax({
            type:"GET",
            url:"http://saulodacruz2-001-site1.itempurl.com/api/Estabelecimento/ObterTodos",
            success:function(retorno){
            gridEstabelecimento.draw().clear()
            var objeto = JSON.parse(retorno);
            if(objeto.length>=0){
                for(i=0;i<objeto.length;i++){
                gridEstabelecimento.row.add([
                objeto[i].Nome,
                objeto[i].NomeFantasia,
                objeto[i].Descricao,
                objeto[i].HorarioFuncionamento,
                objeto[i].CNPJ,
                objeto[i].Celular,
                objeto[i].Logradouro,
                objeto[i].UF
            ]).draw(false);
                }
            }
            },
            error:function(erro){
                alert("Aconteceu um erro na requisição: " + erro.respondeText);
            }
        })
    }
</script>
    <!-- Core plugin JavaScript-->
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js "></script>
    <script src="vendor/jquery-easing/jquery.easing.min.js "></script>
    <!-- Custom scripts for all pages-->
    <script src="js/sb-admin.min.js "></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.js"></script>
</body>
</html>